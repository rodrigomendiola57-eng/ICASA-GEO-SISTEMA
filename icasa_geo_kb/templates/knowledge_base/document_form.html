{% extends 'base/base.html' %}
{% load static %}

{% block title %}Crear Documento - ICASA GEO{% endblock %}

{% block extra_head %}
{{ form.media }}
{% endblock %}

{% block content %}
<div class="p-6">
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Crear Nuevo Documento</h1>
        <p class="text-gray-600">Añadir documentación a la base de conocimiento</p>
    </div>

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <form method="post" class="space-y-6">
            {% csrf_token %}
            
            <div>
                <label for="{{ form.title.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                    Título del Documento
                </label>
                {{ form.title }}
                {% if form.title.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.title.errors.0 }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.template_choice.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                    Plantilla de Documento
                </label>
                {{ form.template_choice }}
                <p class="mt-1 text-sm text-gray-500">Selecciona una plantilla predefinida para comenzar</p>
                {% if form.template_choice.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.template_choice.errors.0 }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.category.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                    Categoría
                </label>
                {{ form.category }}
                {% if form.category.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.category.errors.0 }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.content.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                    Contenido
                </label>
                {{ form.content }}
                {% if form.content.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.content.errors.0 }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.tags.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                    Etiquetas
                </label>
                {{ form.tags }}
                <p class="mt-1 text-sm text-gray-500">Separar múltiples etiquetas con comas</p>
                {% if form.tags.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.tags.errors.0 }}</p>
                {% endif %}
            </div>

            <div class="flex justify-end space-x-3">
                <a href="{% url 'knowledge_base:home' %}" 
                   class="bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg">
                    Cancelar
                </a>
                <button type="submit" 
                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                    Crear Documento
                </button>
            </div>
        </form>
    </div>
</div>

<style>
.form-input, .form-textarea, .form-select {
    @apply w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500;
}
</style>

<script>
// Plantillas de documentos
const templates = {
    'politica': `<h1>POLÍTICA [NOMBRE DE LA POLÍTICA]</h1>

<h2>1. OBJETIVO</h2>
<p>Definir el objetivo principal de esta política...</p>

<h2>2. ALCANCE</h2>
<p>Esta política aplica a...</p>

<h2>3. DEFINICIONES</h2>
<ul>
    <li><strong>Término 1:</strong> Definición...</li>
    <li><strong>Término 2:</strong> Definición...</li>
</ul>

<h2>4. POLÍTICA</h2>
<p>Descripción detallada de la política...</p>

<h2>5. RESPONSABILIDADES</h2>
<ul>
    <li><strong>Gerencia:</strong> Responsabilidades específicas...</li>
    <li><strong>Supervisores:</strong> Responsabilidades específicas...</li>
    <li><strong>Empleados:</strong> Responsabilidades específicas...</li>
</ul>`,
    
    'procedimiento': `<h1>PROCEDIMIENTO [NOMBRE DEL PROCEDIMIENTO]</h1>

<h2>1. PROPÓSITO</h2>
<p>Describir el propósito y objetivo del procedimiento...</p>

<h2>2. ALCANCE</h2>
<p>Este procedimiento aplica a...</p>

<h2>3. PROCEDIMIENTO</h2>
<ol>
    <li><strong>Paso 1:</strong> Descripción detallada del primer paso...</li>
    <li><strong>Paso 2:</strong> Descripción detallada del segundo paso...</li>
    <li><strong>Paso 3:</strong> Descripción detallada del tercer paso...</li>
</ol>`,
    
    'manual': `<h1>MANUAL DE USUARIO - [NOMBRE DEL SISTEMA/PROCESO]</h1>

<h2>1. INTRODUCCIÓN</h2>
<p>Bienvenido al manual de usuario de...</p>

<h2>2. PRIMEROS PASOS</h2>
<p>Para comenzar a utilizar el sistema...</p>

<h2>3. FUNCIONALIDADES PRINCIPALES</h2>
<p>Las principales funciones incluyen...</p>`,
    
    'descripcion_puesto': `<h1>DESCRIPCIÓN DE PUESTO</h1>

<h2>INFORMACIÓN GENERAL</h2>
<p><strong>Título del Puesto:</strong> [NOMBRE DEL PUESTO]</p>
<p><strong>Departamento:</strong> [DEPARTAMENTO]</p>
<p><strong>Reporta a:</strong> [PUESTO SUPERVISOR]</p>

<h2>PROPÓSITO DEL PUESTO</h2>
<p>Descripción general del propósito...</p>

<h2>FUNCIONES PRINCIPALES</h2>
<ol>
    <li>Función principal 1...</li>
    <li>Función principal 2...</li>
    <li>Función principal 3...</li>
</ol>`
};

function loadTemplate(templateKey) {
    if (templateKey && templates[templateKey]) {
        // Obtener la instancia de CKEditor
        const editorInstance = CKEDITOR.instances['id_content'];
        if (editorInstance) {
            editorInstance.setData(templates[templateKey]);
        }
    }
}
</script>
{% endblock %}